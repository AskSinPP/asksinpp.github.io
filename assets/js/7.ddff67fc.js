(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{431:function(e,t,n){"use strict";n.r(t);var r=n(59),s=Object(r.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"hmsensor"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#hmsensor"}},[e._v("#")]),e._v(" HMSensor")]),e._v(" "),r("p",[e._v("Das "),r("a",{attrs:{href:"https://github.com/pa-pa/HMSensor/",target:"_blank",rel:"noopener noreferrer"}},[e._v("HMSensor Projekt"),r("OutboundLink")],1),e._v(" stammt von pa-pa und versucht\neine universelle Hardware-Basis f√ºr AskSin++ Sensoren und Aktoren zu sein. Die Gr√∂√üe der Platine ist\ndabei nur 40x20mm und damit nur geringf√ºgig gr√∂√üer als ein Pro-Mini.")]),e._v(" "),r("p",[e._v("Die Platine gibt es in der StepUp und CR2032 Variante. Die jeweiligen Bauteillisten sind\nauf Github hinterlegt.")]),e._v(" "),r("p",[e._v("PS: Keine Angst vor SMD, mit etwas √úbung lassen sich HMSensor Platinen mit einem normalen L√∂tkolben best√ºcken.\nMit einer guten Pinzette, Flux und Entl√∂tlitze sowie einer Lupe oder Mikroskop hat man eine gute Grundausstattung.\nYoutube bietet einige gute Videos die den Einstieg erleichtern. Hat man den Dreh erst mal raus, dann will man\nkeine Beinchen mehr abknipsen nach dem L√∂ten üôÇ")]),e._v(" "),r("h2",{attrs:{id:"hmsensor-stepup"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#hmsensor-stepup"}},[e._v("#")]),e._v(" HMSensor-StepUp")]),e._v(" "),r("p",[e._v("Durch den StepUp Wandler erreicht man eine m√∂glichst gute Ausnutzung der Batteriekapazit√§t.\nZus√§tzlich ist eine externe Messung der Batteriespannung m√∂glich.")]),e._v(" "),r("p",[e._v("Beide Varianten k√∂nnen mit einem 32kHz Quarz ausgestattet werden wenn man\ngenauere Timings ben√∂tigt. Zus√§tzlich kann er den Ruhestrom weiter senken, siehe\n"),r("a",{attrs:{href:"https://github.com/TomMajor/SmartHome/tree/master/Info/Ruhestrom",target:"_blank",rel:"noopener noreferrer"}},[e._v("Ruhestrom Arduino Pro Mini"),r("OutboundLink")],1),e._v("\nvon Tom Major.")]),e._v(" "),r("p",[r("img",{attrs:{src:n(527),alt:"HMSensor StepUp"}}),e._v(" "),r("img",{attrs:{src:n(528),alt:"HMSensor StepUp"}})]),e._v(" "),r("p",[e._v("Will man auf den externen Quarz verzichten, dann bleiben "),r("code",[e._v("C4")]),e._v(", "),r("code",[e._v("C5")]),e._v(" und "),r("code",[e._v("Y1")]),e._v(" unbest√ºckt.")]),e._v(" "),r("p",[r("img",{attrs:{src:n(529),alt:"HMSensor StepUp Oberseite Teile"}})]),e._v(" "),r("p",[e._v("Ben√∂tigt man keinen StepUp Wandler kann der Jumper "),r("code",[e._v("J1")]),e._v(" geschlossen werden.\nDie Bauteile "),r("code",[e._v("L1")]),e._v(", "),r("code",[e._v("C6")]),e._v(", "),r("code",[e._v("C7")]),e._v(" und "),r("code",[e._v("IC3")]),e._v(" bleiben unbest√ºckt. Zudem kann man ohne StepUp die\nBatteriemessugn am AVR-VCC nutzen und ben√∂tigt den Spannungsteiler √ºber "),r("code",[e._v("R4")]),e._v(" und "),r("code",[e._v("R5")]),e._v(" nicht.")]),e._v(" "),r("p",[r("img",{attrs:{src:n(530),alt:"HMSensor StepUp Oberseite Teile"}})]),e._v(" "),r("h2",{attrs:{id:"hmsensor-cr2032"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#hmsensor-cr2032"}},[e._v("#")]),e._v(" HMSensor-CR2032")]),e._v(" "),r("p",[e._v("Hat man keinen Platz f√ºr "),r("em",[e._v("gro√üe")]),e._v(" Batterien greift man auf eine CR2032-Zelle zur√ºck.\nSie wird in einen Halter auf der Oberseite gesteckt, der ATmega328P sitzt bei dieser\nVariante auf der R√ºckseite. Da Knopfzellen andere Entlade-Eigenschaften haben kann\nhier auf einen StepUp Wandler verzichtet werden.")]),e._v(" "),r("p",[r("img",{attrs:{src:n(531),alt:"HMSensor CR2032 Oberseite"}}),e._v(" "),r("img",{attrs:{src:n(532),alt:"HMSensor CR2032 R√ºckseite"}}),e._v(" "),r("img",{attrs:{src:n(533),alt:"HMSensor CR2032 Oberseite Teile"}}),e._v(" "),r("img",{attrs:{src:n(534),alt:"HMSensor CR2032 R√ºckseite Teile"}})]),e._v(" "),r("div",{staticClass:"custom-block tip"},[r("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),r("p",[e._v("Wird die Antenne am L√∂tauge "),r("code",[e._v("ANT")]),e._v(" der HMSensor verbaut, betr√§gt die L√§nge nur noch 72mm.")]),e._v(" "),r("p",[e._v("Auf die mittlere Kontaktfl√§che f√ºr die Knopfzelle sollte etwas Zinn aufgetragen werden damit die Erh√∂hung\neinen besseren Kontakt zu erm√∂glicht.")])]),e._v(" "),r("h2",{attrs:{id:"addons"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#addons"}},[e._v("#")]),e._v(" Addons")]),e._v(" "),r("p",[e._v("F√ºr die HMSensor gibt es diverse "),r("a",{attrs:{href:"https://github.com/pa-pa/HMSensor/tree/master/AddOns",target:"_blank",rel:"noopener noreferrer"}},[e._v("Addon-Platinen"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("h2",{attrs:{id:"software"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#software"}},[e._v("#")]),e._v(" Software")]),e._v(" "),r("p",[e._v("Beide Varianten f√ºhren die ISP sowie die UART Pins nach au√üen.")]),e._v(" "),r("p",[r("img",{attrs:{src:n(535),alt:"Anschluss √ºber Pin-Header"}}),e._v(" "),r("img",{attrs:{src:n(536),alt:"Anschluss √ºber Pogos auf FlashStation"}})]),e._v(" "),r("h3",{attrs:{id:"bootloader-und-fuses"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#bootloader-und-fuses"}},[e._v("#")]),e._v(" Bootloader und Fuses")]),e._v(" "),r("p",[e._v("Da der ATmega328P ohne Bootloader kommt, wird dieser per ISP-Programmer aufgespielt.\nEs empfiehlt sich die Verwendung des\n"),r("a",{attrs:{href:"https://www.diamex.de/dxshop/USB-ISP-Programmer-fuer-Atmel-AVR-Rev2",target:"_blank",rel:"noopener noreferrer"}},[e._v("Diamex"),r("OutboundLink")],1),e._v(" Programmers,\nda dieser auch auf dem SPI-Interface 3,3V liefert => DIP-Schalterstellung pr√ºfen!")]),e._v(" "),r("div",{staticClass:"custom-block warning"},[r("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),r("p",[e._v("Bei Verwendung eins USBasp sollte das CC1101 Funkmodul noch "),r("strong",[e._v("nicht")]),e._v(" best√ºckt sein, da es keine 5V vertr√§gt.")])]),e._v(" "),r("p",[e._v("Der Anschluss des ISP erfolgt nach Beschriftung.\n"),r("img",{attrs:{src:n(537),alt:"ISP Pinout"}})]),e._v(" "),r("p",[e._v("Der "),r("a",{attrs:{href:"https://raw.githubusercontent.com/pa-pa/AskSinPP/master/bootloader/avr/ATmegaBOOT_168_atmega328_pro_8MHz.hex",target:"_blank",rel:"noopener noreferrer"}},[e._v("Arudino Bootloader"),r("OutboundLink")],1),e._v(" dient zum sp√§teren Flashen der Sketches per UART (FTDI)\nAdapter.")]),e._v(" "),r("p",[e._v("Es ist auch m√∂glich einen OTA-Bootloader aufzuspielen, siehe dazu\n"),r("a",{attrs:{href:"https://wiki.fhem.de/wiki/HomeMatic_Fenster-Drehgriffkontakt_Community-Nachbau#Firmware",target:"_blank",rel:"noopener noreferrer"}},[e._v("OTA-Firmware"),r("OutboundLink")],1),e._v("\nim FEHM Wiki. Der OTA-Bootloader ben√∂igt etwas mehr Platz weshalb als High-Fuse "),r("code",[e._v("0xD0")]),e._v(" verwendet wird.")]),e._v(" "),r("p",[e._v("F√ºr den Arduino-Bootloader mit deaktiviertem BOD k√∂nnen folgende Fuses gesetzt werden."),r("br"),e._v("\nSiehe auch "),r("RouterLink",{attrs:{to:"/Grundlagen/FAQ/babbling_idiot.html#dauersender-babbling-idiot"}},[e._v("Babbling Idiot")]),e._v(".")],1),e._v(" "),r("div",{staticClass:"language-bash line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Fuses setzen")]),e._v("\navrdude -p m328p -P /dev/ttyACM3 -c avrisp2 -B "),r("span",{pre:!0,attrs:{class:"token number"}},[e._v("10")]),e._v(" -U lfuse:w:0xE2:m -U hfuse:w:0xD2:m -U efuse:w:0xFF:m -U lock:w:0xFF:m\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Upload des Arudino Bootloaders")]),e._v("\navrdude -p m328p -P /dev/ttyACM3 -c avrisp2 -V -U flash:w:ATmegaBOOT_168_atmega328_pro_8MHz.hex\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Bootloader verifizieren")]),e._v("\navrdude -p m328p -P /dev/ttyACM3 -c avrisp2 -U flash:v:ATmegaBOOT_168_atmega328_pro_8MHz.hex\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br"),r("span",{staticClass:"line-number"},[e._v("5")]),r("br"),r("span",{staticClass:"line-number"},[e._v("6")]),r("br"),r("span",{staticClass:"line-number"},[e._v("7")]),r("br"),r("span",{staticClass:"line-number"},[e._v("8")]),r("br")])]),r("p",[e._v("Es ist darauf zu achten, dass die Memory-Operation ("),r("code",[e._v("-U")]),e._v(") keine Leerzeichen enthalten darf.\nDie Parameter f√ºr den Port "),r("code",[e._v("-P")]),e._v(" und den Programmer "),r("code",[e._v("-c")]),e._v(" m√ºssen an die jeweilige Umgebung angepasst werden.\nBeispielsweise "),r("code",[e._v("-P usb -c usbasp")]),e._v(" f√ºr den USBasp unter Windows.")]),e._v(" "),r("h3",{attrs:{id:"sketche"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#sketche"}},[e._v("#")]),e._v(" Sketche")]),e._v(" "),r("p",[e._v("Sketche werden wie gewohnt √ºber den UART (FTDI) geflasht.")]),e._v(" "),r("p",[e._v("Alternativ k√∂nnte man den Bootloader auch weglassen und den Sketch direkt per ISP aufspielen. Der FTDI w√ºrde\ndann nur noch zur Anzeige des seriellen Monitors ben√∂tigt.")]),e._v(" "),r("p",[r("strong",[e._v("Anschluss des FTDI an die HMSensor:")])]),e._v(" "),r("table",[r("thead",[r("tr",[r("th",[e._v("HMSensor")]),e._v(" "),r("th",[e._v("FTDI")]),e._v(" "),r("th")])]),e._v(" "),r("tbody",[r("tr",[r("td",[e._v("VCC")]),e._v(" "),r("td",[e._v("VCC")]),e._v(" "),r("td",[e._v("3.3V")])]),e._v(" "),r("tr",[r("td",[e._v("GND")]),e._v(" "),r("td",[e._v("GND")]),e._v(" "),r("td")]),e._v(" "),r("tr",[r("td",[e._v("TX")]),e._v(" "),r("td",[e._v("RX")]),e._v(" "),r("td")]),e._v(" "),r("tr",[r("td",[e._v("RX")]),e._v(" "),r("td",[e._v("TX")]),e._v(" "),r("td")]),e._v(" "),r("tr",[r("td",[e._v("RESET")]),e._v(" "),r("td",[e._v("DTR")]),e._v(" "),r("td",[r("strong",[e._v("100nF Kondensator in Reihe schalten!")])])])])]),e._v(" "),r("h2",{attrs:{id:"ruhestrom"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#ruhestrom"}},[e._v("#")]),e._v(" Ruhestrom")]),e._v(" "),r("p",[e._v("Den Ruhestrom kann man mit den SleepTest Sketches von Tom √ºberpr√ºfen:\n"),r("a",{attrs:{href:"https://github.com/TomMajor/SmartHome/tree/master/Info/Ruhestrom",target:"_blank",rel:"noopener noreferrer"}},[e._v("Infos zum Ruhestrom"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("Es sind schon F√§lle aufgetreten, bei denen der Ruhestrom bei ~15mA lag.\nSchuld waren "),r("em",[e._v('"defekte"')]),e._v(" CC1101 Module.")]),e._v(" "),r("h2",{attrs:{id:"links"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#links"}},[e._v("#")]),e._v(" Links")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://github.com/pa-pa/HMSensor/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Github Repo"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://forum.fhem.de/index.php/topic,73954.0.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("FHEM Forum Thread"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/psi-4ward/HMSensor-FlashStation",target:"_blank",rel:"noopener noreferrer"}},[e._v("HMSensor FlashStation"),r("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=s.exports},527:function(e,t,n){e.exports=n.p+"assets/img/StepUp-Top.21c04e73.png"},528:function(e,t,n){e.exports=n.p+"assets/img/StepUp-Bottom.dd973271.png"},529:function(e,t,n){e.exports=n.p+"assets/img/StepUp-Top-Parts.6bc15914.svg"},530:function(e,t,n){e.exports=n.p+"assets/img/StepUp-Bottom-Parts.c6ed1fda.svg"},531:function(e,t,n){e.exports=n.p+"assets/img/CR2032-Top.c116c8ea.png"},532:function(e,t,n){e.exports=n.p+"assets/img/CR2032-Bottom.d96a229c.png"},533:function(e,t,n){e.exports=n.p+"assets/img/CR2032-Top-Parts.850f9f66.svg"},534:function(e,t,n){e.exports=n.p+"assets/img/CR2032-Bottom-Parts.db444def.svg"},535:function(e,t,n){e.exports=n.p+"assets/img/Anschluss-Pinheader.8ec8f6de.jpg"},536:function(e,t,n){e.exports=n.p+"assets/img/HMSensor-FlashStation_1.39d585f0.jpg"},537:function(e,t,n){e.exports=n.p+"assets/img/ISP-Pinout.f57779d3.jpg"}}]);