(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{485:function(s,t,n){"use strict";n.r(t);var a=n(60),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"weiteres"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#weiteres"}},[s._v("#")]),s._v(" Weiteres")]),s._v(" "),n("h2",{attrs:{id:"freqtest"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#freqtest"}},[s._v("#")]),s._v(" FreqTest")]),s._v(" "),n("p",[s._v("Für den STM32 gibt es einen angepassten "),n("a",{attrs:{href:"https://github.com/pa-pa/AskSinPP/blob/master/examples/stm32/FreqTest/FreqTest.ino",target:"_blank",rel:"noopener noreferrer"}},[s._v("FreqTest.ino"),n("OutboundLink")],1),s._v(" Sketch zum ermitteln der optimalen\nFrequenz für das CC1101 Funkmodul. Der Wert kann allerdings (noch) nicht auf dem EEPROM gespeichert\nwerden weshalb man ihn hardcoded im Sketch hinterlegen muss.")]),s._v(" "),n("p",[n("em",[s._v("Beispiel Upload über PlatformIO und FTDI oder USB-Bootloader:")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$ cd AskSinPP/examples/stm32/FreqTest\n$ pio run -t upload -e dfu\n...\n\n$ pio device monitor\n\n--- Miniterm on /dev/ttyACM0  57600,8,N,1 ---\n--- Quit: Ctrl+C | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H ---\nAskSin++ V4.1.1 (Nov  9 2019 16:37:02)\nCC init1\n...\nDone: 0x21657A - 0x21664A\nCalculated Freq: 0x2165E2\n 868.347 MHz\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("p",[s._v("Im Sketch kann nun die Frequenz hardcodiert hinterlegt werden:")]),s._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setup")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// init stuff ...")]),s._v("\n  sdev"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initDone")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CC1101 Frequency after sdev.init")]),s._v("\n  hal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("radio"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initReg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CC1101_FREQ2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x21")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  hal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("radio"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initReg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CC1101_FREQ1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x65")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  hal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("radio"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initReg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CC1101_FREQ0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xE2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h2",{attrs:{id:"hw-serial"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#hw-serial"}},[s._v("#")]),s._v(" HW-Serial")]),s._v(" "),n("p",[s._v("Einige Mikrocontroller wie der STM32 oder auch AVR644/1286 besitzen eine UUID,\nalso eine unverwechselbare 128-Bit-Zahl. AskSin++ kann diese UUID nutzen um\nwiederum eine eindeutige Device-ID sowie Serial zu berechnen. Dies\nmacht die Anpassung im DeviceInfo-Block des Sketch überflüssig:")]),s._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Derive ID and Serial from the device UUID")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[n("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("USE_HW_SERIAL")])]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DeviceInfo")]),s._v(" PROGMEM devinfo "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ID and Serial is derived from STM32-UUID (see #define USE_HW_SERIAL)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Device ID")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0000000000"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("           "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Device Serial")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x01")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x09")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Device Model: HM-DW-WM 2-channel LED dimmer")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x2C")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("                   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Firmware Version")]),s._v("\n    as"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("DeviceType"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),s._v("Dimmer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Device Type")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x01")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("             "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Info Bytes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);